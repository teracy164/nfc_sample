<html>
    <head>
        <script>
            const isSupportedNFC = () => {
                if ('NDEFReader' in window) {
                    return true;
                } else {
                    return false;
                }
            }
            const readNFC = async () => {
                return new Promise(async (resolve, reject) => {
                    try {
                        const reader = new NDEFReader();
                        await reader.scan();

                        reader.onreading = event => {
                            console.log(event);
                            resolve(event);
                        }
                        reader.onerror = event => {
                            console.error(event);
                            reject(event);
                        }
                    } catch (err) {
                        console.error(err);
                        reject();
                    }
                });
            }
            const startNFC = () => {
                document.getElementById('btn').setAttribute('disabled', true);
                document.getElementById('result').innerText = 'Loading';
                readNFC().then(result => {
                    document.getElementById('result').innerText = JSON.stringify(result);
                    document.getElementById('btn').setAttribute('disabled', false);
                }).catch(err => {
                    document.getElementById('result').innerText = JSON.stringify(err);
                    document.getElementById('btn').removeAttribute('disabled');
                })
            };

            window.onload = () => {
                if (isSupportedNFC()) {
                    console.log('nfc supported.')
                    document.getElementById('btn').style.display='';
                } else {
                    console.log('nfc not supported.')
                    document.getElementById('btn').style.display='none';
                }                
            }
        </script>
    </head>
    <body>
        <button id="btn" onclick="startNFC()">start NFC</button>
        <div id="result">

        </div>
    </body>
</html>
